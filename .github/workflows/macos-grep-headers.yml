name: Grep Mac headers

on:
  pull_request:

jobs:
  build:
    runs-on: macos-15
    name: Find it
    env:
      CXX: /opt/homebrew/opt/llvm@18/bin/clang++
      CC: /opt/homebrew/opt/llvm@18/bin/clang
    defaults:
      run:
        shell: bash -l {0}
    steps:
      - name: Print include paths
        run: /opt/homebrew/opt/llvm@18/bin/clang++ -E -x c++ - -v < /dev/null
      - name: Grep /Library/Developer/CommandLineTools/SDKs/MacOSX15.sdk/usr/include
        if: always()
        run: grep -Rn "IP_MULTICAST_IF" /Library/Developer/CommandLineTools/SDKs/MacOSX15.sdk/usr/include
      - name: Grep /Library/Developer/CommandLineTools/SDKs/MacOSX15.sdk/System/Library/Frameworks
        if: always()
        run: grep -Rn "IP_MULTICAST_IF" /Library/Developer/CommandLineTools/SDKs/MacOSX15.sdk/System/Library/Frameworks
      - name: Cat /Library/Developer/CommandLineTools/SDKs/MacOSX15.sdk/usr/include/netinet/in.h
        if: always()
        run: cat /Library/Developer/CommandLineTools/SDKs/MacOSX15.sdk/usr/include/netinet/in.h
